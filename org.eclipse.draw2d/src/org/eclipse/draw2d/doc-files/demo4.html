<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>

<head>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
</head>

<body>

<div align="center">
    <center>
    <table width="100%" style="border-collapse: collapse" bordercolor="#111111" cellpadding="0" cellspacing="0">
        <tr>
            <td bgcolor="#000080" colspan="2"><b><font color="#FFFFFF">Example 4 - 
            Connections and Anchors</font></b></td>
        </tr>
        <tr>
            <td><br>
            This example shows how to use Connections and ConnectionAnchors.&nbsp; A 
            connection is a figure that visually connects two anchors.&nbsp; The anchors 
            are usually places on figures which the connection is linking.<p>The red and 
            blue &quot;nodes&quot; can be dragged around with the mouse.&nbsp; The connection will 
            re-route itself automatically.&nbsp; The connections children, the &quot;Midpoint&quot; 
            label and the arrowhead, will also update.</p>
            <p>The connection implementation used here is {@link 
            org.eclipse.draw2d.PolylineConnection PolylineConnection}.&nbsp; This 
            implementation supports decorations, such as arrowheads.&nbsp; {link 
            org.eclipse.draw2d.PolygonDecoration PolygonDecorations} added to the 
            connection will be rotated correctly by a {@link org.eclipse.draw2d.Locator 
            Locator}.&nbsp; Other decorations can be added with their own locators, such 
            as the &quot;Midpoint&quot; label in the demo.<br>
&nbsp;</td>
            <td><img border="0" src="demo4.gif" width="243" height="245"></td>
        </tr>
    </table>
    <table width="100%" style="border-collapse: collapse" bordercolor="#111111" cellpadding="0" cellspacing="0">
        <tr>
            <td valign="top"><font size="-1">
            <pre>import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.Shell;
import org.eclipse.swt.widgets.Display;
import org.eclipse.draw2d.*;
import org.eclipse.draw2d.geometry.*;

public class Demo4 {

public static void main(String args[]){
Shell shell = new Shell();
shell.setSize(350,350);
shell.open();
shell.setText(&quot;Demo 4&quot;);
LightweightSystem lws = new LightweightSystem(shell);
IFigure panel = new Figure();
lws.setContents(panel);
RectangleFigure
node1 = new RectangleFigure(),
node2 = new RectangleFigure();
node1.setBackgroundColor(ColorConstants.red);
node2.setBackgroundColor(ColorConstants.blue);
node2.setLocation(new Point(100,100));

PolylineConnection conn = new PolylineConnection();
conn.setSourceAnchor(new ChopboxAnchor(node1));
conn.setTargetAnchor(new ChopboxAnchor(node2));
conn.setTargetDecoration(new PolygonDecoration());

Label label = new Label(&quot;Midpoint&quot;);
label.setOpaque(true);
label.setBackgroundColor(ColorConstants.buttonLightest);
label.setBorder(new LineBorder());
conn.add(label, new MidpointLocator(conn, 0));

panel.add(node1);
panel.add(node2);
panel.add(conn);
new Dragger(node1);
new Dragger(node2);
Display display = Display.getDefault();
while (!shell.isDisposed()) {
if (!display.readAndDispatch())
display.sleep ();
}

}
static class Dragger extends MouseMotionListener.Stub implements MouseListener {
public Dragger(IFigure figure){
figure.addMouseMotionListener(this);
figure.addMouseListener(this);
}
Point last;
public void mouseReleased(MouseEvent e){}
public void mouseClicked(MouseEvent e){}
public void mouseDoubleClicked(MouseEvent e){}
public void mousePressed(MouseEvent e){
last = e.getLocation();
}
public void mouseDragged(MouseEvent e){
Point p = e.getLocation();
Dimension delta = p.getDifference(last);
last = p;
Figure f = ((Figure)e.getSource());
f.setBounds(f.getBounds().getTranslated(delta.width, delta.height));
}
};

}</pre>
            </font></td>
        </tr>
    </table>
    </center>
</div>
<p>&nbsp;</p>

</body>

</html>
